function init(){var e=navigator.userAgent;e.indexOf("MSIE")>0?e.indexOf("10")>0||e.indexOf("11")>0?adSupported():backup():adSupported()}function adSupported(){console&&console.log("[Studio Enabler] Callback set to: init()\n				 Common methods: Enabler.exitoverride(ID, URL), Enabler.counter(ID, true)\n				 Custom methods: loadVideoMetrics(), getURL(URL)"),startAD()}function startAD(){trace(version),gallery=config.module.gallery.photos,Enabler.getUserZipCode()?(trace("Studio Locaton detected"),userZip=Enabler.getUserZipCode(),prePreload()):(trace("no zip"),prePreload())}function prePreload(){trace("prepreload"),preload([getURL(config.intro),getURL(config.header.image),getURL(config.footer.image),getURL(config.module.bg)],adStart)}function adStart(){trace("adstart"),Enabler.addEventListener(studio.events.StudioEvent.EXIT,function(){videoTabActive&&toggleVideoTab(0)}),trace("start listeners"),document.getElementById("header").onclick=buttonHandler,document.getElementById("backup").onclick=buttonHandler,document.getElementById("buy-now").onclick=buttonHandler,document.getElementById("header_locator").onclick=buttonHandler,document.getElementById("header_gallery").onclick=buttonHandler,document.getElementById("header_video").onclick=buttonHandler,document.getElementById("footer").onclick=buttonHandler,document.getElementById("video_cta").onclick=buttonHandler,document.getElementById("mod_gallery").onclick=buttonHandler,document.getElementById("mod_locator").onclick=buttonHandler,document.getElementById("zip_field").onclick=buttonHandler,document.getElementById("btn_zip").onclick=buttonHandler,document.getElementById("btn_zip2").onclick=buttonHandler,document.getElementById("btn_prev").onclick=buttonHandler,document.getElementById("btn_next").onclick=buttonHandler,document.getElementById("close_gallery").onclick=buttonHandler,document.getElementById("close_locator").onclick=buttonHandler,document.getElementById("close_video").onclick=buttonHandler,document.getElementById("toggleList").onclick=buttonHandler,document.getElementById("toggleMap").onclick=buttonHandler,document.getElementById("watch_btn_video").onclick=buttonHandler,trace("start load images"),document.getElementById("container").style.opacity=1,document.getElementById("backup").src=getURL(config.intro),document.getElementById("header").src=getURL(config.header.image),document.getElementById("footer").src=getURL(config.footer.image),document.getElementById("watch_btn_video").src=getURL(config.module.watchMore),document.getElementById("btnList").src=getURL(config.module.listOff),document.getElementById("btnMap").src=getURL(config.module.mapOn),document.getElementById("tab_gallerybg").src=getURL(config.module.bg),document.getElementById("tab_videobg").src=getURL(config.module.bg),document.getElementById("tab_locatorbg").src=getURL(config.module.bg),document.getElementById("locator_posterimg").src=getURL("https://maps.googleapis.com/maps/api/staticmap?center="+userZip+"&zoom=8&size=290x128"),document.getElementById("tab_locatorimg").src=getURL("https://maps.googleapis.com/maps/api/staticmap?center="+userZip+"&zoom=8&size=300x500"),document.getElementById("btn_zip").src=getURL(config.module.locator.button),document.getElementById("btn_zip2").src=getURL(config.module.locator.button),document.getElementById("gallery_posterimg").src=getURL(config.module.gallery.poster),document.getElementById("video_smallposter").src=getURL(config.module.video.poster.small),trace("intro animation"),setTimeout(function(){removeClass(document.getElementById("header"),"start")},1e3),setTimeout(function(){removeClass(document.getElementById("subcontainer"),"start")},1800),toggleSpinner(0),setVideo(),peeked=0,setTimeout(triggerAP,3e3)}function triggerAP(){document.getElementById("loader").style.backgroundColor="rgba(0, 0, 0, 0.4)",peeked>=2||(autoPeek(document.getElementById("mod_gallery"),"mod_active",100),autoPeek(document.getElementById("mod_locator"),"mod_active",2e3),setTimeout(triggerAP,6e3),peeked++)}function autoPeek(e,t,o){var n=e.getElementsByClassName("animate")[0];setTimeout(function(){addClass(n,t),setTimeout(function(){video.ismobile||removeClass(n,t)},1e3)},o)}function buttonHandler(e){switch(e.currentTarget.id){case"buy-now":trace("--- buy-now exit"),Enabler.exit("CTA_BUY_NOW_CLICK");break;case"header":trace("--- header exit"),Enabler.exit("HEADER_CLICK");break;case"header_gallery":trace("--- header exit"),Enabler.exit("HEADER_CLICK");break;case"header_locator":trace("--- header exit"),Enabler.exit("HEADER_CLICK");break;case"header_video":trace("--- header exit"),Enabler.exit("HEADER_CLICK");break;case"footer":trace("--- footer exit"),Enabler.exit("FOOTER_CLICK");break;case"learnMore0":trace("--- learnMore0 exit"),Enabler.exit("CTA_LEARNMORE_S1_CLICK");break;case"learnMore1":trace("--- learnMore2 exit"),Enabler.exit("CTA_LEARNMORE_S2_CLICK");break;case"learnMore2":trace("--- learnMore2 exit"),Enabler.exit("CTA_LEARNMORE_S3_CLICK");break;case"watch_btn_video":trace("--- video-cta exit"),Enabler.exit("CTA_VIDEO_LEARN_HOW_CLICK");break;case"video_cta":toggleVideoTab(1),Enabler.counter("VIDEO_OPEN");break;case"mod_gallery":toggleGallery(1),Enabler.counter("GALLERY_OPEN");break;case"mod_locator":toggleLocator(1),Enabler.counter("LOCATOR_OPEN");break;case"close_locator":toggleLocator(0),Enabler.counter("LOCATOR_CLOSE");break;case"close_gallery":toggleGallery(0),Enabler.counter("GALLERY_CLOSE");break;case"close_video":toggleVideoTab(0),Enabler.counter("VIDEO_CLOSE");break;case"btn_prev":currentSlide>0&&activeButtons&&(addClass(document.getElementById("btn_prev"),"disabled"),addClass(document.getElementById("btn_next"),"disabled"),toggleSpinner(1),preload([getURL(config.module.gallery.photos[currentSlide-1][0])],function(){toggleSpinner(0),loadSlide(currentSlide-1)}),Enabler.counter("GALLERY_INTERACTIONS",!0),Enabler.counter("GALLERY_PREVIOUS"));break;case"btn_next":currentSlide<gallery.length-1&&activeButtons&&(addClass(document.getElementById("btn_prev"),"disabled"),addClass(document.getElementById("btn_next"),"disabled"),toggleSpinner(1),preload([getURL(config.module.gallery.photos[currentSlide+1][0])],function(){toggleSpinner(0),loadSlide(currentSlide+1)}),Enabler.counter("GALLERY_INTERACTIONS",!0),Enabler.counter("GALLERY_NEXT"));break;case"zip_field":"ZIP code"==document.getElementById("zip_field").value&&(document.getElementById("zip_field").value=""),addClass(document.getElementById("zip_field"),"zip_active");break;case"zip_field2":"ZIP code"==document.getElementById("zip_field2").value&&(document.getElementById("zip_field2").value=""),addClass(document.getElementById("zip_field2"),"zip_active");break;case"btn_zip":document.getElementById("zip_field").value.length&&"ZIP code"!=document.getElementById("zip_field").value&&(userZip=document.getElementById("zip_field").value,document.getElementById("zip_field2").value=document.getElementById("zip_field").value,addClass(document.getElementById("zip_field2"),"zip_active"),Enabler.counter("LOCATOR_INTERACTIONS",!0),Enabler.counter("LOCATOR_ZIP"),loadLocationList());break;case"btn_zip2":document.getElementById("zip_field2").value.length&&"ZIP code"!=document.getElementById("zip_field2").value&&(userZip=document.getElementById("zip_field2").value,Enabler.counter("LOCATOR_INTERACTIONS",!0),Enabler.counter("LOCATOR_ZIP"),loadLocationList());break;case"toggleList":Enabler.counter("LOCATOR_INTERACTIONS",!0),Enabler.counter("LOCATOR_TOGGLE_LIST"),toggleSecondaryLocator(2);break;case"toggleMap":Enabler.counter("LOCATOR_INTERACTIONS",!0),Enabler.counter("LOCATOR_TOGGLE_MAP"),toggleSecondaryLocator(1);break;case"backup":Enabler.exit("BACKGROUND_CLICK");break;default:Enabler.exitOverride("HEADER_CLICK",config.header.exit)}}function loadmap(e,t){map?t&&t():gmap.locate.find(e,function(e){zipCenter=e,document.getElementById("map_locations").innerHTML="",gmap.init({id:"map_locations",zoom:8,center:e},t)})}function loadLocationList(e){locations=[],toggleSpinner(1),geocoder.geocode({address:userZip},function(e,t){if(t==google.maps.GeocoderStatus.OK){var o=e[0].geometry.location,n=o.lat(),l=o.lng(),a="ST_INTERSECTS(faddress,CIRCLE(LATLNG("+n+","+l+"),32000))",d=30,i=new XMLHttpRequest,r="https://www.googleapis.com/fusiontables/v1/query?sql=SELECT%20name%2Cfaddress%2Clat%2Clng%2Czip%20FROM%201LPhq5V2k8QFAw48nDfEhGUmLNg5hsXHJLdyoSdyb%20WHERE%20"+a+"&key="+ftkey;i.onload=function(){if(200===i.status)if(toggleSpinner(0),JSON.parse(i.response).rows){console.log(JSON.parse(i.responseText)),document.getElementById("map_listings").innerHTML="",gmap.marker.clear();var t=document.getElementById("map_listings"),o=document.createElement("div");o.style.top=0,o.style.zIndex=90,o.style.backgroundColor="#FFF",o.id="locationList";var n=JSON.parse(i.responseText).rows;n.forEach(function(t){gmap.getDistance(e[0].geometry.location,new google.maps.LatLng(t[2],t[3]),function(e){isNaN(e)?t[5]=100:t[5]=e}),++a});var l=n.length;l>40&&(l=40),n=n.sort(function(e,t){return e[5]-t[5]});for(var a=0;l>a;a++){var d={};d.id=a,d.name=n[a][0],d.address=n[a][1],d.lat=n[a][2],d.lng=n[a][3],d.loc=null,locations.push(d);var r=document.createElement("div");r.className="btn cell",r.id="location"+d.id,r.onclick=findMarker;var c=document.createElement("div");c.className="name",c.innerHTML=d.name;var m=document.createElement("div");if(m.className="address",m.innerHTML=d.address,r.appendChild(c),r.appendChild(m),o.appendChild(r),"number"==typeof d.lat&&"number"==typeof d.lng){var s=new google.maps.LatLng(d.lat,d.lng);locations[d.id].loc=s,locations[d.id].info='<div style="overflow: hidden !important; line-height: 18px;"><b>'+d.name+"</b><br>"+d.address+"</div>",gmap.marker.add(locations[d.id]),gmap.fit()}else gmap.locate.find(d.address,function(e,t){console.log(e),locations[d.id].loc=e,locations[d.id].info=t,gmap.marker.add(locations[d.id]),gmap.fit()},'<div style="overflow: hidden !important;"><b>'+d.name+"</b><br>"+d.address+"</div>")}gmap.fitBound(gmap.marker.list.markers),console.log(map.getZoom()+" <<< ZOOM"),t.appendChild(o),toggleSecondaryLocator(2)}else alert("No locations at zipcode "+userZip)},trace("--- OPEN"),trace("--- "+r),i.open("GET",r,!0),trace("--- SEND"),trace("--- "+userZip),i.send()}else toggleSpinner(0),alert("Please enter a valid Zip Code")})}function findMarker(e){Enabler.counter("LOCATOR_INTERACTIONS",!0),Enabler.counter("LOCATOR_FIND_MARKER");var t=locations[Number(e.currentTarget.id.substring(8))];trace(t),t.loc?(gmap.center(t.loc,!0),gmap.zoom(15)):gmap.locate.find(t.address,function(e){trace(e);var t={loc:e};gmap.center(t.loc,!0),gmap.zoom(15)}),toggleSecondaryLocator(1)}function toggleGallery(e){e?(toggleSpinner(1),preload([getURL(config.module.gallery.photos[0][0])],function(){toggleSpinner(0),addClass(document.getElementById("tab_gallery"),"tabactive"),loadSlide(0,!0)})):(removeClass(document.getElementById("tab_gallery"),"tabactive"),setTimeout(function(){document.getElementById("slides").innerHTML=""},500))}function closeColor(e){for(var t=document.getElementsByClassName("close_tab"),o=0;o<t.length;o++)t[o].style.color=e}function toggleSecondaryLocator(e){switch(e){case 1:document.getElementById("secondary_content").style.visibility="visible",document.getElementById("locator_bgscreen").style.opacity=0,document.getElementById("map_listings").style.visibility="hidden",document.getElementById("map_listings").style.overflow="hidden",document.getElementById("map_locations").style.visibility="visible",document.getElementById("btnList").src=getURL(config.module.listOff),document.getElementById("btnMap").src=getURL(config.module.mapOn);break;case 2:document.getElementById("secondary_content").style.visibility="visible",document.getElementById("locator_bgscreen").style.opacity=0,document.getElementById("map_listings").style.visibility="visible",document.getElementById("map_listings").style.overflow="auto",document.getElementById("map_locations").style.visibility="hidden",document.getElementById("btnList").src=getURL(config.module.listOn),document.getElementById("btnMap").src=getURL(config.module.mapOff);break;default:document.getElementById("secondary_content").style.visibility="hidden",document.getElementById("locator_bgscreen").style.opacity=1,document.getElementById("map_listings").style.overflow="hidden",document.getElementById("map_listings").style.visibility="hidden",document.getElementById("map_locations").style.visibility="hidden",document.getElementById("btnList").src=getURL(config.module.listOff),document.getElementById("btnMap").src=getURL(config.module.mapOn)}}function toggleLocator(e){var t=document.getElementsByClassName("close_tab_locator"),o=new google.maps.LatLng(40.7127837,-74.00594130000002),n=8;map=new google.maps.Map(document.getElementById("map_locations"),{center:o,zoom:n,mapTypeControl:!1,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP}),google.maps.event.addListener(map,"tilesloaded",function(e){isMapCreated||(geocoder=new google.maps.Geocoder),isMapCreated=!0});for(var l=0;l<t.length;l++)t[l].style.color=config.module.close_color_locator;e?(addClass(document.getElementById("tab_locator"),"tabactive"),toggleSecondaryLocator(0)):(removeClass(document.getElementById("tab_locator"),"tabactive"),gmap.marker.clear())}function toggleVideoTab(e){e?videoTabActive||(videoTabActive=!0,document.getElementById("video_title").innerHTML=config.module.video.title,document.getElementById("video_info").innerHTML=config.module.video.description,video.ismobile?video.play():(video.obliterate(),video.init("video_bigcontainer"),video.load(getURL(config.module.video.files),getURL(config.module.video.poster.big))),addClass(document.getElementById("tab_video"),"tabactive")):videoTabActive&&(videoTabActive=!1,removeClass(document.getElementById("tab_video"),"tabactive"),video.ismobile?video.stop():(video.obliterate(),toggleVideoSmallPoster(1),video.init("video_smallcontainer"),video.load(getURL(config.module.video.files),getURL(config.module.video.poster.big))))}function setVideo(){video.userAgent(),video.uniquereplay=!1,video.dom.template.bigplay=function(){video.dom.bigplay=document.createElement("span"),video.dom.bigplay.className="fa fa-play-circle-o",video.dom.bigplay.style.color=video.colors.play_pause,video.dom.bigplay.style.fontSize="50px",video.trace("using new play")},video.ismobile?video.autoplay=!1:video.autoplay=!0,video.callback.ready=function(){"video_smallcontainer"===video.dom.container.id?Enabler.counter("AUTOVIDEO_STARTS"):(Enabler.counter("VIDEO_STARTS",!0),videoended=!1)},video.callback.ended=function(){videoTabActive&&(Enabler.counter("VIDEO_ENDS",!0),videoended=!0,toggleVideoSmallPoster(1))},video.callback.pause=function(){videoTabActive&&Enabler.counter("VIDEO_PAUSE")},video.callback.volumechange=function(){videoTabActive&&(video.isMuted()?Enabler.counter("VIDEO_MUTE"):Enabler.counter("VIDEO_UNMUTE"))},video.callback.play=function(){!videoTabActive&&video.autoplay?(video.mute(),toggleVideoSmallPoster(0)):videoended?(fquart=!1,squart=!1,tquart=!1,Enabler.counter("VIDEO_REPLAY"),Enabler.counter("VIDEO_STARTS",!0),videoended=!1):Enabler.counter("VIDEO_PLAY")},video.callback.progress=function(){if(videoTabActive){var e=video.duration/2,t=e/2,o=e+e/2;!fquart&&video.playhead>t&&(Enabler.counter("VIDEO_FIRST_QUARTILE"),fquart=!0),!squart&&video.playhead>e&&(Enabler.counter("VIDEO_SECOND_QUARTILE"),squart=!0),!tquart&&video.playhead>o&&(Enabler.counter("VIDEO_THIRD_QUARTILE"),tquart=!0)}else document.getElementById("v_controls").style.opacity=0,video.playhead>=10&&(Enabler.counter("AUTOVIDEO_ENDS"),video.stop(),toggleVideoSmallPoster(1))},video.ismobile?video.init("video_bigcontainer"):video.init("video_smallcontainer"),video.load(getURL(config.module.video.files),getURL(config.module.video.poster.big))}function toggleVideoSmallPoster(e){e?document.getElementById("video_smallposter").style.opacity=1:document.getElementById("video_smallposter").style.opacity=0}function toggleSpinner(e){e?(document.getElementById("loader").style.visibility="visible",addClass(document.getElementById("loader"),"loader_active")):(removeClass(document.getElementById("loader"),"loader_active"),setTimeout(function(){document.getElementById("loader").style.visibility="hidden"},500))}function loadSlide(e,t){if(activeButtons=!1,e!=currentSlide||t){var o,n;o=e>currentSlide?"slide_left":"slide_right",t?(o=null,addClass(document.getElementById("btn_prev"),"disabled")):n=document.getElementById("slide_"+currentSlide),currentSlide=e;var l=document.getElementById("slides"),a=document.createElement("div");a.id="slide_"+currentSlide,a.className="slide abs animate",a.style.backgroundImage="url("+getURL(config.module.bg)+")",a.style.backgroundPosition="0 -68px";var d=document.createElement("img");d.src=getURL(config.module.gallery.photos[currentSlide][0]),a.appendChild(d);var i=document.createElement("div");i.innerHTML="slide "+(currentSlide+1)+"/"+config.module.gallery.photos.length,i.className="text_slide abs",a.appendChild(i);var r=document.createElement("div");r.className="slide_infowrapper abs",a.appendChild(r);var c=document.createElement("div");c.className="text_title rel lato",c.innerHTML=config.module.gallery.photos[currentSlide][1],r.appendChild(c);var m=document.createElement("div");m.className="text_info rel lato",m.innerHTML=config.module.gallery.photos[currentSlide][2],r.appendChild(m);var s=document.createElement("img");s.className="abs btn learn_more_gallery",s.id="learnMore"+currentSlide,s.src=config.module.watchMore,r.appendChild(s);var g=document.createElement("div");void 0!=config.module.gallery.photos[currentSlide][3]&&(g.className="text_attr rel lato",g.innerHTML=config.module.gallery.photos[currentSlide][3],r.appendChild(g)),slides.appendChild(a),document.getElementById(s.id).onclick=null,document.getElementById(s.id).onclick=buttonHandler,setTimeout(function(){n&&addClass(n,o)},100),setTimeout(function(){removeClass(document.getElementById("btn_prev"),"disabled"),removeClass(document.getElementById("btn_next"),"disabled"),n&&(removeClass(n,"forcetop"),n.parentNode.removeChild(n)),addClass(a,"forcetop"),0===currentSlide&&addClass(document.getElementById("btn_prev"),"disabled"),currentSlide===gallery.length-1&&addClass(document.getElementById("btn_next"),"disabled"),activeButtons=!0},500)}}function autoGallery(){config.module.gallery.photos?galleryTimer=setTimeout(function(){clearTimeout(galleryTimer),preload([config.module.gallery.photos[gIndex][0]],function(){var e=document.createElement("img");e.className="abs animate mslide",e.style.opacity=0,e.src=config.module.gallery.photos[gIndex][0],document.getElementById("mini-slideshow").appendChild(e),e.style.top=(e.offsetHeight-document.getElementById("mod_gallery").offsetHeight)/2*-1+"px",setTimeout(function(){e.style.opacity=1},50),gIndex++,galleryLen>gIndex?setTimeout(autoGallery,800):setTimeout(function(){document.getElementById("mini-slideshow").style.opacity=0,setTimeout(function(){document.getElementById("mini-slideshow").parentNode.removeChild(document.getElementById("mini-slideshow"))},1e3)},3e3)})},3e3):trace("no photos")}var gallery=[],currentSlide=0,version="1.1",firstTime=!0,videoTabActive=!1,activeButtons=!0,videoVirgin=!0,userZip="10011",peeked,zipCenter,ftkey="AIzaSyD5BTFfjgxluZ1J9UaFg_68TJcmNA2JHfo",isMapCreated=!1,circleRef=new google.maps.Circle,videoended=!1,fquart=!1,squart=!1,tquart=!1,galleryTimer,gIndex=0,galleryLen;galleryLen=config.module.gallery.photos.length<3?config.module.gallery.photos.length:3;